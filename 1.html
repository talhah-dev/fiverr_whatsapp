<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>WhatsApp — one overlay (text only)</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome (header icons only) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
        crossorigin="anonymous" />
    <!-- Lucide (thin outline icons for the sheet) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        .chat-wallpaper {
            background:
                radial-gradient(circle at 2px 2px, rgba(0, 0, 0, .05) 2px, transparent 2px) 0 0/30px 30px,
                linear-gradient(180deg, #efeae2 0%, #e5ddd5 100%);
        }

        .wh-header {
            background: #008069;
        }

        .sent {
            background: #DCF8C6;
        }

        .phone {
            box-shadow: 0 24px 60px rgba(0, 0, 0, .25), 0 3px 12px rgba(0, 0, 0, .12);
        }

        .glass {
            background: linear-gradient(180deg, rgba(255, 255, 255, .78), rgba(255, 255, 255, .58));
            backdrop-filter: blur(18px) saturate(120%);
            -webkit-backdrop-filter: blur(18px) saturate(120%);
            border: 1px solid rgba(255, 255, 255, .45);
        }

        /* Overlay: fade only to avoid edge gaps; animate inner layers instead */
        .fade {
            transition: opacity .18s ease-out;
        }

        #overlay.ov-hidden {
            opacity: 0;
            pointer-events: none;
        }

        #overlay.ov-shown {
            opacity: 1;
            pointer-events: auto;
        }

        .anim {
            transition: opacity .18s ease-out, transform .18s ease-out;
        }

        #overlay.ov-hidden .anim {
            opacity: 0;
            transform: translateY(6px) scale(.98);
        }

        #overlay.ov-shown .anim {
            opacity: 1;
            transform: none;
        }

        /* Reactions pill */
        #reactions {
            background: rgba(255, 255, 255, .94);
            backdrop-filter: blur(12px) saturate(120%);
            -webkit-backdrop-filter: blur(12px) saturate(120%);
            border: 1px solid rgba(0, 0, 0, .06);
            box-shadow: 0 12px 28px rgba(0, 0, 0, .14), 0 2px 4px rgba(0, 0, 0, .06);
        }

        #reactions span {
            line-height: 1;
            transform: translateY(1px);
        }

        .rx-more {
            width: 28px;
            height: 28px;
            display: grid;
            place-items: center;
            border-radius: 9999px;
            background: rgba(255, 255, 255, .96);
            border: 1px solid rgba(0, 0, 0, .08);
            color: #525252;
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, .8), 0 6px 18px rgba(0, 0, 0, .08);
        }

        .rx-more:hover {
            background: #fff;
            color: #3f3f3f;
        }

        .rx-more svg {
            width: 16px;
            height: 16px;
        }

        /* Sheet rows + outline icons */
        .wa-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
        }

        .wa-item:hover {
            background: rgba(255, 255, 255, .45);
            transition: background .15s ease;
        }

        #sheet .wa-ico>svg {
            width: 22px;
            height: 22px;
            stroke-width: 1.8;
        }

        #sheet svg {
            stroke: currentColor;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .wa-sheet {
            min-width: 276px;
            border-radius: 18px;
            overflow: hidden;
            background: linear-gradient(180deg, #f6f7f8 0%, #eceeef 100%);
            border: 1px solid rgba(0, 0, 0, .08);
            box-shadow: 0 22px 44px rgba(0, 0, 0, .20), 0 3px 8px rgba(0, 0, 0, .10);
        }

        .wa-list {
            font-size: 15px;
            color: #111;
        }

        .wa-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background: rgba(255, 255, 255, .65);
        }

        .wa-item+.wa-item {
            border-top: 1px solid rgba(0, 0, 0, .085);
        }

        .wa-item:hover {
            background: rgba(255, 255, 255, .9);
            transition: background .15s ease;
        }

        .wa-ico>svg {
            width: 22px;
            height: 22px;
            stroke-width: 1.8;
        }

        .wa-sheet svg {
            stroke: currentColor;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        /* “Delete” row color */
        .wa-danger {
            color: #d92d20;
        }

        .wa-danger .wa-ico>svg {
            stroke: currentColor;
        }

        /* Thick divider above “Mehr …” */
        .wa-sep {
            height: 10px;
            background: linear-gradient(180deg, rgba(0, 0, 0, .06), rgba(0, 0, 0, .02));
            border-top: 1px solid rgba(0, 0, 0, .08);
            border-bottom: 1px solid rgba(0, 0, 0, .08);
        }
    </style>
</head>

<body class="min-h-screen bg-neutral-200 flex items-center justify-center p-6">

    <section id="phone" class="phone relative w-[392px] h-[780px] bg-white rounded-[32px] overflow-hidden">
        <!-- Header -->
        <header class="wh-header h-14 px-4 flex items-center gap-3 text-white">
            <i class="fa-solid fa-angle-left text-xl"></i>
            <div class="w-9 h-9 rounded-full bg-white/20"></div>
            <div class="flex-1">
                <p class="text-[15px] font-semibold leading-4">Aleyna</p>
                <p class="text-xs text-white/80 leading-4">online</p>
            </div>
            <i class="fa-solid fa-video text-lg"></i>
            <i class="fa-solid fa-phone text-lg ml-4"></i>
            <i class="fa-solid fa-ellipsis-vertical text-lg ml-4"></i>
        </header>

        <!-- Chat -->
        <div id="chat" class="chat-wallpaper h-[calc(100%-56px)] overflow-y-auto p-3 pb-24 relative">
            <div class="space-y-2">
                <div class="flex justify-end">
                    <div class="max-w-[72%] rounded-2xl rounded-br-md px-3 py-2 text-[13px] sent">On my way 🚗</div>
                </div>
                <div class="flex justify-end">
                    <div class="max-w-[72%] rounded-2xl rounded-br-md px-3 py-2 text-[13px] sent">5 mins</div>
                </div>
            </div>

            <!-- received TEXT ONLY (after two texts) -->
            <div class="mt-6">
                <div data-bubble
                    class="inline-block max-w-[82%] bg-white rounded-2xl rounded-bl-md px-3 py-2 shadow-sm cursor-pointer">
                    <p class="text-[14px] text-neutral-800">
                        Aleyna ich komm dich jetzt abholen – hab neuen AMG, lass ihn einweihen
                    </p>
                    <div class="text-[10px] text-neutral-400 mt-1 text-right">16:54</div>
                </div>
            </div>
        </div>

        <!-- Input -->
        <footer class="absolute bottom-0 left-0 right-0 bg-white border-t px-3 py-2 flex items-center gap-2">
            <i class="fa-regular fa-face-smile text-xl text-neutral-600"></i>
            <input class="flex-1 rounded-full bg-neutral-100 px-4 py-2 text-[14px] w-full outline-none"
                placeholder="Nachricht schreiben…" />
            <i class="fa-solid fa-paperclip text-lg text-neutral-600"></i>
            <button class="w-10 h-10 rounded-full text-white grid shrink-0 place-items-center" style="background:#008069;">
                <i class="fa-solid fa-paper-plane"></i>
            </button>
        </footer>

        <!-- ============= ONE OVERLAY (blur + emojis + dropdown) ============= -->
        <div id="overlay" class="absolute inset-0 z-50 ov-hidden fade">
            <!-- white blur; sits ABOVE chat but BELOW the promoted bubble -->
            <div id="ov-bg" class="absolute inset-0 bg-white/55 backdrop-blur-[3px] z-[50]"></div>

            <!-- emoji bar (top layer) -->
            <div id="reactions" class="anim absolute z-[70] rounded-full px-3 py-1 flex items-center gap-2">
                <span class="text-[20px] leading-none">👍</span>
                <span class="text-[20px] leading-none">❤️</span>
                <span class="text-[20px] leading-none">😂</span>
                <span class="text-[20px] leading-none">😮</span>
                <span class="text-[20px] leading-none">😢</span>
                <span class="text-[20px] leading-none">🙏</span>
                <span class="text-[20px] leading-none">🔥</span>
                <button class="rx-more ml-1" aria-label="More reactions">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.25"
                        stroke-linecap="round">
                        <path d="M12 5v14M5 12h14" />
                    </svg>
                </button>
            </div>

            <!-- WhatsApp-like dropdown -->
            <div id="sheet" class="anim absolute z-[70] rounded-2xl overflow-hidden border border-black/10 shadow-2xl
            bg-gradient-to-b from-neutral-100 to-neutral-100">
                <ul class="min-w-[270px] text-[15px] text-neutral-900 divide-y divide-black/10">

                    <!-- Antworten (reply, curved to left) -->
                    <li class="flex items-center justify-between px-4 py-3 hover:bg-white/70 transition">
                        <span>Antworten</span><i data-lucide="corner-down-left" class="wa-ico w-5 h-5"></i>
                    </li>

                    <!-- Weiterleiten (forward, curved to right) -->
                    <li class="flex items-center justify-between px-4 py-3 hover:bg-white/70 transition">
                        <span>Weiterleiten</span><i data-lucide="corner-down-right" class="wa-ico w-5 h-5"></i>
                    </li>

                    <!-- Kopieren -->
                    <li class="flex items-center justify-between px-4 py-3 hover:bg-white/70 transition">
                        <span>Kopieren</span>
                        <i data-lucide="copy" class="w-5 h-5"></i>
                    </li>

                    <!-- Mit Stern markieren -->
                    <li class="flex items-center justify-between px-4 py-3 hover:bg-white/70 transition">
                        <span>Mit Stern markieren</span>
                        <i data-lucide="star" class="w-5 h-5"></i>
                    </li>

                    <!-- Löschen (red) -->
                    <li class="flex items-center justify-between px-4 py-3 hover:bg-white/70 transition text-red-600">
                        <span>Löschen</span>
                        <i data-lucide="trash-2" class="w-5 h-5"></i>
                    </li>

                    <!-- thick separator like iOS -->
                    <li class="h-2 bg-neutral-300/40"></li>

                    <!-- Mehr … (circled three dots) -->
                    <li class="flex items-center justify-between px-4 py-3 hover:bg-white/70 transition">
                        <span>Mehr …</span>
                        <!-- custom circled ellipsis -->
                        <svg viewBox="0 0 24 24" class="w-5 h-5 stroke-[1.8] text-neutral-800" fill="none"
                            stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="8.8" />
                            <circle cx="9" cy="12" r="1.5" fill="currentColor" stroke="none" />
                            <circle cx="12" cy="12" r="1.5" fill="currentColor" stroke="none" />
                            <circle cx="15" cy="12" r="1.5" fill="currentColor" stroke="none" />
                        </svg>
                    </li>
                </ul>
            </div>

        </div>
    </section>

    <script>
        const phone = document.getElementById('phone');
        const chat = document.getElementById('chat');
        const overlay = document.getElementById('overlay');
        const ovBg = document.getElementById('ov-bg');
        const reactions = document.getElementById('reactions');
        const sheet = document.getElementById('sheet');

        let activeBubble = null;
        const clamp = (v, min, max) => Math.max(min, Math.min(max, v));
        const openOverlay = () => overlay.classList.replace('ov-hidden', 'ov-shown');
        const closeOverlay = () => {
            overlay.classList.replace('ov-shown', 'ov-hidden');
            if (activeBubble) {
                activeBubble.style.position = '';
                activeBubble.style.zIndex = '';
                activeBubble.removeEventListener('click', closeOverlay);
                activeBubble = null;
            }
        };

        function openFor(bubble) {
            const p = phone.getBoundingClientRect();
            const b = bubble.getBoundingClientRect();
            const pad = 8;

            // Lift the clicked bubble ABOVE the blur but BELOW emojis/sheet
            activeBubble = bubble;
            bubble.style.position = 'relative';
            bubble.style.zIndex = '60'; // ov-bg is z-50, emojis/sheet are z-70

            openOverlay();

            // position sheet & emoji bar
            reactions.style.left = '0px'; reactions.style.top = '0px';
            sheet.style.left = '0px'; sheet.style.top = '0px';

            requestAnimationFrame(() => {
                const rxW = reactions.offsetWidth, rxH = reactions.offsetHeight;
                const shW = sheet.offsetWidth, shH = sheet.offsetHeight;

                // SHEET below (flip above if needed)
                const belowY = (b.top - p.top) + b.height + 10;
                const aboveY = (b.top - p.top) - shH - 10;
                const shTop = ((b.bottom + shH + 40) > p.bottom)
                    ? clamp(aboveY, pad, p.height - shH - pad)
                    : clamp(belowY, pad, p.height - shH - pad);
                const shLeft = clamp(b.left - p.left, pad, p.width - shW - pad);
                sheet.style.left = shLeft + 'px';
                sheet.style.top = shTop + 'px';

                // EMOJI bar: align LEFT with sheet
                let rxLeft = shLeft;
                let rxTop = (b.top - p.top) - rxH - 8;
                if (rxTop < pad) rxTop = (b.top - p.top) + b.height + 8;
                rxLeft = clamp(rxLeft, pad, p.width - rxW - pad);
                reactions.style.left = rxLeft + 'px';
                reactions.style.top = rxTop + 'px';
            });

            // Allow tapping the bubble again to close
            bubble.addEventListener('click', closeOverlay);
        }

        // Open for any bubble
        document.querySelectorAll('[data-bubble]').forEach(b => {
            b.addEventListener('click', e => { e.stopPropagation(); openFor(b); });
        });

        // Close by clicking background / ESC / scroll
        ovBg.addEventListener('click', closeOverlay);
        document.addEventListener('keydown', e => { if (e.key === 'Escape') closeOverlay(); });
        chat.addEventListener('scroll', () => { if (overlay.classList.contains('ov-shown')) closeOverlay(); });

        // Render Lucide icons
        if (window.lucide && lucide.createIcons) { lucide.createIcons(); }
    </script>

</body>

</html>