<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>WhatsApp ‚Ä¢ simple overlay (click to show/hide)</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
        crossorigin="anonymous" />

    <style>
        /* WhatsApp look */
        .chat-wallpaper {
            background:
                radial-gradient(circle at 2px 2px, rgba(0, 0, 0, .05) 2px, transparent 2px) 0 0/30px 30px,
                linear-gradient(180deg, #efeae2 0%, #e5ddd5 100%);
        }

        .wh-header {
            background: #008069;
        }

        .sent {
            background: #DCF8C6;
        }

        .phone {
            box-shadow: 0 24px 60px rgba(0, 0, 0, .25), 0 3px 12px rgba(0, 0, 0, .12);
        }

        /* Frosted/glass UI */
        .glass {
            background: linear-gradient(180deg, rgba(255, 255, 255, .78), rgba(255, 255, 255, .58));
            backdrop-filter: blur(18px) saturate(120%);
            -webkit-backdrop-filter: blur(18px) saturate(120%);
            border: 1px solid rgba(255, 255, 255, .45);
        }

        /* Overlay transitions */
        .fade {
            transition: opacity .18s ease-out, transform .18s ease-out;
        }

        .ov-hidden {
            opacity: 0;
            transform: translateY(6px) scale(.98);
            pointer-events: none;
        }

        .ov-shown {
            opacity: 1;
            transform: translateY(0) scale(1);
            pointer-events: auto;
        }
    </style>
</head>

<body class="min-h-screen bg-neutral-200 flex items-center justify-center p-6">
    <section id="phone" class="phone relative w-[392px] h-[780px] bg-white rounded-[32px] overflow-hidden">
        <!-- Header -->
        <header class="wh-header h-14 px-4 flex items-center gap-3 text-white">
            <i class="fa-solid fa-angle-left text-xl"></i>
            <div class="w-9 h-9 rounded-full bg-white/20"></div>
            <div class="flex-1">
                <p class="text-[15px] font-semibold leading-4">Aleyna</p>
                <p class="text-xs text-white/80 leading-4">online</p>
            </div>
            <i class="fa-solid fa-video text-lg"></i>
            <i class="fa-solid fa-phone text-lg ml-4"></i>
            <i class="fa-solid fa-ellipsis-vertical text-lg ml-4"></i>
        </header>

        <!-- Chat -->
        <div id="chat" class="chat-wallpaper h-[calc(100%-56px)] overflow-y-auto p-3 pb-24 relative">
            <div class="space-y-2">
                <div class="flex justify-end">
                    <div class="max-w-[72%] rounded-2xl rounded-br-md px-3 py-2 text-[13px] sent">On my way üöó</div>
                </div>
                <div class="flex justify-end">
                    <div class="max-w-[72%] rounded-2xl rounded-br-md px-3 py-2 text-[13px] sent">5 mins</div>
                </div>
            </div>

            <!-- Text bubble -->
            <div class="mt-6">
                <div data-bubble
                    class="inline-block max-w-[82%] bg-white rounded-2xl rounded-bl-md px-3 py-2 shadow-sm cursor-pointer">
                    <p class="text-[14px] text-neutral-800">
                        Aleyna ich komm dich jetzt abholen ‚Äì hab neuen AMG, lass ihn einweihen
                    </p>
                    <div class="text-[10px] text-neutral-400 mt-1 text-right">16:54</div>
                </div>
            </div>

            <!-- Image bubble -->
            <div class="mt-4">
                <div data-bubble
                    class="inline-block max-w-[88%] rounded-2xl rounded-bl-md overflow-hidden shadow-sm bg-white cursor-pointer">
                    <img class="block w-full h-[190px] object-cover"
                        src="https://images.unsplash.com/photo-1704340142770-b52988e5b6eb?w=900&auto=format&fit=crop&q=60"
                        alt="car" />
                    <div class="text-[10px] text-neutral-400 px-2 py-1 text-right">16:54</div>
                </div>
            </div>
        </div>

        <!-- Input -->
        <footer class="absolute bottom-0 left-0 right-0 bg-white border-t px-3 py-2 flex items-center gap-2">
            <i class="fa-regular fa-face-smile text-xl text-neutral-600"></i>
            <input class="flex-1 rounded-full bg-neutral-100 px-4 py-2 text-[14px] outline-none"
                placeholder="Nachricht schreiben‚Ä¶" />
            <i class="fa-solid fa-paperclip text-lg text-neutral-600"></i>
            <button class="w-10 h-10 rounded-full text-white grid place-items-center" style="background:#008069;">
                <i class="fa-solid fa-paper-plane"></i>
            </button>
        </footer>

        <!-- ============== ONE OVERLAY (blur + emoji + dropdown) ============== -->
        <div id="overlay" class="absolute inset-0 z-[60] ov-hidden fade">
            <!-- White blur background (under UI, over chat) -->
            <div id="ov-bg" class="absolute inset-0 bg-white/55 backdrop-blur-[3px] z-[60]"></div>

            <!-- Emoji bar (top UI layer) -->
            <div id="reactions" class="glass shadow-lg rounded-full px-3 py-1 flex items-center gap-2 absolute z-[80]">
                <span class="text-[18px]">üëç</span>
                <span class="text-[18px]">‚ù§Ô∏è</span>
                <span class="text-[18px]">üòÇ</span>
                <span class="text-[18px]">üòÆ</span>
                <span class="text-[18px]">üò¢</span>
                <span class="text-[18px]">üôè</span>
                <span class="text-[18px]">üî•</span>
                <button class="ml-1 w-6 h-6 rounded-full bg-white/40 grid place-items-center text-neutral-700">
                    <i class="fa-solid fa-plus text-xs"></i>
                </button>
            </div>

            <!-- Dropdown (top UI layer) -->
            <div id="sheet" class="glass rounded-2xl overflow-hidden shadow-2xl border border-white/40 absolute z-[80]">
                <ul class="text-[14px] min-w-[270px]">
                    <li class="flex items-center justify-between px-4 py-3 hover:bg-white/45 transition">
                        <span>Antworten</span><i class="fa-solid fa-reply"></i></li>
                    <li class="flex items-center justify-between px-4 py-3 hover:bg-white/45 transition">
                        <span>Weiterleiten</span><i class="fa-solid fa-share"></i></li>
                    <li class="flex items-center justify-between px-4 py-3 hover:bg-white/45 transition">
                        <span>Kopieren</span><i class="fa-regular fa-copy"></i></li>
                    <li class="flex items-center justify-between px-4 py-3 hover:bg-white/45 transition"><span>Mit Stern
                            markieren</span><i class="fa-regular fa-star"></i></li>
                    <li class="flex items-center justify-between px-4 py-3 hover:bg-white/45 transition">
                        <span>Fixieren</span><i class="fa-solid fa-thumbtack"></i></li>
                    <li class="flex items-center justify-between px-4 py-3 hover:bg-white/45 transition">
                        <span>Melden</span><i class="fa-regular fa-flag"></i></li>
                    <li class="flex items-center justify-between px-4 py-3 hover:bg-red-500/10 text-red-600 transition">
                        <span>L√∂schen</span><i class="fa-solid fa-trash"></i></li>
                </ul>
            </div>
        </div>
    </section>

    <script>
        const phone = document.getElementById('phone');
        const chat = document.getElementById('chat');
        const overlay = document.getElementById('overlay');
        const ovBg = document.getElementById('ov-bg');
        const reactions = document.getElementById('reactions');
        const sheet = document.getElementById('sheet');

        let activeBubble = null;

        const clamp = (v, min, max) => Math.max(min, Math.min(max, v));
        const openOverlay = () => overlay.classList.replace('ov-hidden', 'ov-shown');
        const closeOverlay = () => {
            overlay.classList.replace('ov-shown', 'ov-hidden');
            if (activeBubble) {
                activeBubble.style.position = '';
                activeBubble.style.zIndex = '';
                activeBubble = null;
            }
        };

        function openFor(bubble) {
            const p = phone.getBoundingClientRect();
            const b = bubble.getBoundingClientRect();
            const pad = 8;

            // Keep bubble visible above blur (but below UI)
            activeBubble = bubble;
            bubble.style.position = 'relative';
            bubble.style.zIndex = '70';   // blur is 60, UI is 80

            // Show overlay
            openOverlay();

            // Reset before measuring
            reactions.style.left = '0px'; reactions.style.top = '0px';
            sheet.style.left = '0px'; sheet.style.top = '0px';

            requestAnimationFrame(() => {
                const rxW = reactions.offsetWidth, rxH = reactions.offsetHeight;
                const shW = sheet.offsetWidth, shH = sheet.offsetHeight;

                // Position dropdown under the bubble (flip above if needed)
                const belowY = (b.top - p.top) + b.height + 10;
                const aboveY = (b.top - p.top) - shH - 10;
                const shTop = ((b.bottom + shH + 40) > p.bottom)
                    ? clamp(aboveY, pad, p.height - shH - pad)
                    : clamp(belowY, pad, p.height - shH - pad);
                const shLeft = clamp(b.left - p.left, pad, p.width - shW - pad);
                sheet.style.left = shLeft + 'px';
                sheet.style.top = shTop + 'px';

                // Emoji bar aligned to sheet's left edge
                let rxLeft = shLeft;
                let rxTop = (b.top - p.top) - rxH - 8;
                if (rxTop < pad) rxTop = (b.top - p.top) + b.height + 8;
                rxLeft = clamp(rxLeft, pad, p.width - rxW - pad);
                reactions.style.left = rxLeft + 'px';
                reactions.style.top = rxTop + 'px';
            });
        }

        // Open on click (text or image)
        document.querySelectorAll('[data-bubble]').forEach(el => {
            el.addEventListener('click', e => { e.stopPropagation(); openFor(el); });
        });

        // Close on outside click / ESC / scroll
        ovBg.addEventListener('click', closeOverlay);
        document.addEventListener('keydown', e => { if (e.key === 'Escape') closeOverlay(); });
        chat.addEventListener('scroll', () => { if (overlay.classList.contains('ov-shown')) closeOverlay(); });
    </script>
</body>

</html>